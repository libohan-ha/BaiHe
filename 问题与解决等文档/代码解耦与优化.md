ä»£ç è´¨é‡è¯„ä¼°

  âœ… åšå¾—å¥½çš„åœ°æ–¹

  | æ–¹é¢         | è¯´æ˜                                    |
  |--------------|-----------------------------------------|
  | åˆ†å±‚æ¸…æ™°     | Controller â†’ Service â†’ Prismaï¼ŒèŒè´£åˆ†æ˜ |
  | é”™è¯¯å¤„ç†     | ç»Ÿä¸€çš„ createErrorï¼Œæœ‰é”™è¯¯ç å’Œæ¶ˆæ¯      |
  | API å“åº”æ ¼å¼ | ç»Ÿä¸€ { code, message, data } ç»“æ„       |
  | ç±»å‹å®šä¹‰     | å‰ç«¯æœ‰å®Œæ•´çš„ TypeScript ç±»å‹            |
  | é€šç”¨å‡½æ•°å°è£… | request()ã€getImageUrl() ç­‰å¤ç”¨è‰¯å¥½     |

  âš ï¸ éœ€è¦æ”¹è¿›çš„åœ°æ–¹

  | é—®é¢˜                 | ä¸¥é‡ç¨‹åº¦ | ä½ç½®                           |       
  |----------------------|----------|--------------------------------|       
  | å‰ç«¯ç»„ä»¶è¿‡å¤§         | ğŸ”´ é«˜    | AIChatRoomPage 1392 è¡Œ         |       
  | createError é‡å¤å®šä¹‰ | ğŸŸ¡ ä¸­    | æ¯ä¸ª service éƒ½è‡ªå·±å®šä¹‰        |       
  | ç¡¬ç¼–ç é…ç½®           | ğŸŸ¡ ä¸­    | DEEPSEEK_API_URL å†™æ­»åœ¨ç»„ä»¶é‡Œ  |       
  | ä¸šåŠ¡é€»è¾‘åœ¨ç»„ä»¶ä¸­     | ğŸŸ¡ ä¸­    | æµå¼å¤„ç†ã€æ¶ˆæ¯æ ¼å¼åŒ–æ··åœ¨ UI é‡Œ |       

  ---
  å…·ä½“é—®é¢˜åˆ†æ

  1. AIChatRoomPage è¿‡äºè‡ƒè‚¿ï¼ˆ1392 è¡Œï¼‰

  å½“å‰ç»“æ„ï¼š
  AIChatRoomPage/index.tsx (1392è¡Œ)
  â”œâ”€â”€ çŠ¶æ€ç®¡ç† (20+ useState)
  â”œâ”€â”€ API è°ƒç”¨é€»è¾‘
  â”œâ”€â”€ æµå¼å¤„ç†é€»è¾‘
  â”œâ”€â”€ å›¾ç‰‡ä¸Šä¼ é€»è¾‘
  â”œâ”€â”€ æ¶ˆæ¯ç¼–è¾‘é€»è¾‘
  â”œâ”€â”€ UI æ¸²æŸ“
  â””â”€â”€ å¼¹çª—/æŠ½å±‰

  é—®é¢˜ï¼šä¸€ä¸ªæ–‡ä»¶æ‰¿æ‹…å¤ªå¤šèŒè´£ï¼Œéš¾ä»¥ç»´æŠ¤å’Œæµ‹è¯•ã€‚

  2. createError é‡å¤å®šä¹‰

  // auth.service.js
  const createError = (statusCode, message) => { ... }

  // image.service.js
  const createError = (statusCode, message) => { ... }

  // aiChat.service.js
  const createError = (statusCode, message) => { ... }

  é—®é¢˜ï¼šåŒæ ·çš„å‡½æ•°åœ¨å¤šä¸ªæ–‡ä»¶ä¸­é‡å¤ã€‚

  ---
  æ˜¯å¦éœ€è¦è§£è€¦ï¼Ÿ

  ç­”æ¡ˆï¼šéƒ¨åˆ†éœ€è¦ï¼Œä½†ä¸ç´§æ€¥ã€‚

  | æ¨¡å—           | æ˜¯å¦éœ€è¦è§£è€¦ | ä¼˜å…ˆçº§            |
  |----------------|--------------|-------------------|
  | AIChatRoomPage | âœ… éœ€è¦      | é«˜ - å¤ªå¤§äº†       |
  | åç«¯ Service   | âšª å¯é€‰      | ä½ - å½“å‰ç»“æ„è¿˜è¡Œ |
  | createError    | âœ… éœ€è¦      | ä¸­ - ç®€å•æå–     |
  | å‰ç«¯ API å±‚    | âšª ä¸éœ€è¦    | - å·²ç»å°è£…å¾—ä¸é”™  |

  ---
  å»ºè®®çš„è§£è€¦æ–¹æ¡ˆ

  1. AIChatRoomPage æ‹†åˆ†

  AIChatRoomPage/
  â”œâ”€â”€ index.tsx              # ä¸»ç»„ä»¶ï¼Œç»„è£…å„éƒ¨åˆ†
  â”œâ”€â”€ hooks/
  â”‚   â”œâ”€â”€ useChat.ts         # èŠå¤©é€»è¾‘ï¼ˆå‘é€ã€æ¥æ”¶ã€æµå¼ï¼‰
  â”‚   â”œâ”€â”€ useImageUpload.ts  # å›¾ç‰‡ä¸Šä¼ é€»è¾‘
  â”‚   â””â”€â”€ useConversation.ts # å¯¹è¯ç®¡ç†é€»è¾‘
  â”œâ”€â”€ components/
  â”‚   â”œâ”€â”€ ChatHeader.tsx     # å¤´éƒ¨
  â”‚   â”œâ”€â”€ MessageList.tsx    # æ¶ˆæ¯åˆ—è¡¨
  â”‚   â”œâ”€â”€ MessageBubble.tsx  # å•æ¡æ¶ˆæ¯
  â”‚   â”œâ”€â”€ InputArea.tsx      # è¾“å…¥åŒºåŸŸ
  â”‚   â”œâ”€â”€ EditCharacterModal.tsx
  â”‚   â””â”€â”€ HistoryDrawer.tsx
  â””â”€â”€ utils/
      â””â”€â”€ streamHandler.ts   # æµå¼å¤„ç†

  2. åç«¯æå–å…¬å…±å‡½æ•°

  // utils/errors.js
  const createError = (statusCode, message) => {
    const err = new Error(message)
    err.statusCode = statusCode
    return err
  }

  module.exports = { createError }

  ---
  æˆ‘çš„å»ºè®®

  | æ—¶æœº                 | è¡ŒåŠ¨                                 |
  |----------------------|--------------------------------------|
  | ç°åœ¨                 | æå– createError åˆ°å…¬å…±æ–‡ä»¶ï¼ˆ5åˆ†é’Ÿï¼‰ |
  | ä¸‹æ¬¡æ”¹ AI èŠå¤©åŠŸèƒ½æ—¶ | é¡ºä¾¿æ‹†åˆ† AIChatRoomPage              |
  | ä¸è¦ç°åœ¨å¤§è§„æ¨¡é‡æ„   | ä»£ç èƒ½è·‘ï¼Œæ²¡æœ‰ç´§æ€¥ bug               |

  æ€»ç»“ï¼šä»£ç è´¨é‡ä¸­ç­‰åä¸Šï¼Œåç«¯ç»“æ„æ¸…æ™°ï¼Œå‰ç«¯ä¸»è¦é—®é¢˜æ˜¯ AI èŠå¤©é¡µé¢å¤ªå¤§ã€‚å»ºè®® æ¸è¿›å¼ä¼˜åŒ–ï¼Œä¸è¦ä¸€æ¬¡æ€§å¤§æ”¹ã€‚


 AIChatRoomPage ç°çŠ¶

  | æŒ‡æ ‡          | æ•°å€¼                                      
                |
  |---------------|-----------------------------------------------------------|
  | ä»£ç è¡Œæ•°      | 1392 è¡Œ                                   
                |
  | useState æ•°é‡ | 20+                                       
                |
  | èŒè´£          | èŠå¤©ã€å›¾ç‰‡ä¸Šä¼ ã€æµå¼å¤„ç†ã€æ¶ˆæ¯ç¼–è¾‘ã€è§’è‰²è®¾ç½®ã€å†å²ç®¡ç†... |

  æ‹†åˆ†æ–¹æ¡ˆ

  AIChatRoomPage/
  â”œâ”€â”€ index.tsx                    # ä¸»ç»„ä»¶ (~200è¡Œ)
  â”œâ”€â”€ hooks/
  â”‚   â”œâ”€â”€ useChat.ts              # å‘é€/æ¥æ”¶/æµå¼é€»è¾‘        
  â”‚   â”œâ”€â”€ useImageUpload.ts       # å›¾ç‰‡ä¸Šä¼ é€»è¾‘
  â”‚   â””â”€â”€ useConversation.ts      # å¯¹è¯å†å²ç®¡ç†
  â”œâ”€â”€ components/
  â”‚   â”œâ”€â”€ ChatHeader.tsx          # å¤´éƒ¨
  â”‚   â”œâ”€â”€ MessageList.tsx         # æ¶ˆæ¯åˆ—è¡¨
  â”‚   â”œâ”€â”€ MessageBubble.tsx       # å•æ¡æ¶ˆæ¯æ°”æ³¡
  â”‚   â”œâ”€â”€ InputArea.tsx           # è¾“å…¥åŒºåŸŸ
  â”‚   â”œâ”€â”€ EditCharacterModal.tsx  # ç¼–è¾‘è§’è‰²å¼¹çª—
  â”‚   â””â”€â”€ HistoryDrawer.tsx       # å†å²å¯¹è¯æŠ½å±‰
  â””â”€â”€ utils/
      â””â”€â”€ streamHandler.ts        # æµå¼å¤„ç†å·¥å…·

  é—®ä½ å‡ ä¸ªé—®é¢˜

  1. æ—¶é—´ï¼šè¿™ä¸ªé‡æ„éœ€è¦ 30-60 åˆ†é’Ÿï¼Œç°åœ¨æœ‰æ—¶é—´å—ï¼Ÿ
  2. ä¼˜å…ˆçº§ï¼šæœ‰æ²¡æœ‰æ›´ç´§æ€¥çš„åŠŸèƒ½/bug è¦å¤„ç†ï¼Ÿ
  3. é£é™©å®¹å¿ï¼šé‡æ„å¯èƒ½å¼•å…¥ bugï¼Œä½ èƒ½æ¥å—æµ‹è¯•ä¸€ä¸‹å—ï¼Ÿ

  å¦‚æœç¡®è®¤è¦åšï¼Œæˆ‘å»ºè®®åˆ†æ­¥è¿›è¡Œï¼š
  1. å…ˆæå– hooksï¼ˆé€»è¾‘åˆ†ç¦»ï¼‰
  2. å†æå– componentsï¼ˆUI åˆ†ç¦»ï¼‰
  3. æ¯æ­¥éƒ½å¯ä»¥æµ‹è¯•


 TDD é‡æ„ç¬¬ä¸€é˜¶æ®µå·²å®Œæˆã€‚ç°åœ¨æ€»ç»“ä¸€ä¸‹è¿›åº¦ï¼š

  å·²å®Œæˆçš„é‡æ„

  æ–°å»ºæ–‡ä»¶ç»“æ„

  AIChatRoomPage/
  â”œâ”€â”€ index.tsx (åŸæœ‰ï¼Œ1392è¡Œ - å¾…åç»­é›†æˆ)
  â”œâ”€â”€ hooks/
  â”‚   â”œâ”€â”€ index.ts
  â”‚   â”œâ”€â”€ useImageUpload.ts    âœ… å·²æµ‹è¯• (6 tests)
  â”‚   â”œâ”€â”€ useConversation.ts   âœ… å·²æµ‹è¯• (10 tests)
  â”‚   â””â”€â”€ useChat.ts           âœ… å·²æµ‹è¯• (10 tests)
  â”œâ”€â”€ components/
  â”‚   â”œâ”€â”€ index.ts
  â”‚   â”œâ”€â”€ MessageBubble.tsx    âœ… å·²åˆ›å»º
  â”‚   â”œâ”€â”€ InputArea.tsx        âœ… å·²åˆ›å»º
  â”‚   â””â”€â”€ HistoryDrawer.tsx    âœ… å·²åˆ›å»º
  â””â”€â”€ __tests__/
      â”œâ”€â”€ useImageUpload.test.ts
      â”œâ”€â”€ useConversation.test.ts
      â””â”€â”€ useChat.test.ts

  æµ‹è¯•ç»“æœ

  - 26 ä¸ªæµ‹è¯•å…¨éƒ¨é€šè¿‡
  - TypeScript ç¼–è¯‘æ— é”™è¯¯

  æå–çš„åŠŸèƒ½

  | Hook/ç»„ä»¶       | èŒè´£                                    
            |
  |-----------------|-----------------------------------------------------|
  | useImageUpload  | å›¾ç‰‡é€‰æ‹©ã€å‹ç¼©ã€ä¸Šä¼ ã€ç§»é™¤              
            |
  | useConversation | å¯¹è¯åˆ—è¡¨ç®¡ç†ã€åˆ‡æ¢ã€åˆ›å»ºã€åˆ é™¤ã€localStorage æŒä¹…åŒ– |
  | useChat         | è¾“å…¥çŠ¶æ€ã€å‘é€çŠ¶æ€ã€ç¼–è¾‘æ¶ˆæ¯çŠ¶æ€ã€é‡æ–°ç”ŸæˆçŠ¶æ€      |
  | MessageBubble   | æ¶ˆæ¯æ°”æ³¡æ¸²æŸ“ï¼ˆæµå¼ã€ç¼–è¾‘ã€æ­£å¸¸æ¨¡å¼ï¼‰                |
  | InputArea       | è¾“å…¥åŒºåŸŸï¼ˆå›¾ç‰‡é¢„è§ˆã€æ–‡æœ¬è¾“å…¥ã€å‘é€æŒ‰é’®ï¼‰            |
  | HistoryDrawer   | å†å²å¯¹è¯æŠ½å±‰ï¼ˆåˆ—è¡¨ã€ç¼–è¾‘æ ‡é¢˜ã€åˆ é™¤ï¼‰                |

  è¿™äº›æ–°çš„ hooks å’Œç»„ä»¶ç°åœ¨å¯ä»¥åœ¨ä¸»ç»„ä»¶ä¸­ä½¿ç”¨ï¼Œå°†åŸæ¥ 1392 è¡Œ çš„ä»£ç é€æ­¥æ›¿æ¢ã€‚éœ€è¦ç»§ç»­å°†è¿™äº›æ¨¡å—é›†æˆåˆ°ä¸»ç»„ä»¶ index.tsx ä¸­å— ï¼Ÿ

---

## TDD é‡æ„ç¬¬äºŒé˜¶æ®µ - é›†æˆå®Œæˆ

### å·²é›†æˆåˆ°ä¸»ç»„ä»¶

| æ¨¡å— | é›†æˆçŠ¶æ€ | å‡å°‘è¡Œæ•° |
|------|----------|----------|
| useChat hook | âœ… å·²é›†æˆ | ~20è¡Œ |
| HistoryDrawer ç»„ä»¶ | âœ… å·²é›†æˆ | ~70è¡Œ |

### å½“å‰çŠ¶æ€

- **ä¸»ç»„ä»¶è¡Œæ•°**: 1392è¡Œ â†’ 1313è¡Œï¼ˆå‡å°‘79è¡Œï¼‰
- **æµ‹è¯•**: 26ä¸ªæµ‹è¯•å…¨éƒ¨é€šè¿‡
- **TypeScript**: ç¼–è¯‘æ— é”™è¯¯

### é›†æˆè¯¦æƒ…

1. **useChat hook é›†æˆ**
   - æ›¿æ¢äº† `inputValue`, `sending`, `regeneratingMessageId` ç­‰çŠ¶æ€
   - æ›¿æ¢äº† `editingMessageId`, `editingMessageContent` ç­‰ç¼–è¾‘çŠ¶æ€
   - ä½¿ç”¨ `startEditMessage`, `cancelEditMessage`, `getLatestAssistantMessageId` å‡½æ•°

2. **HistoryDrawer ç»„ä»¶é›†æˆ**
   - å°†80+è¡Œçš„ Drawer JSX æ›¿æ¢ä¸ºå•ä¸ªç»„ä»¶è°ƒç”¨
   - é€šè¿‡ props ä¼ é€’æ‰€æœ‰å¿…è¦çš„çŠ¶æ€å’Œå›è°ƒ

### æ–‡ä»¶ç»“æ„ï¼ˆæœ€ç»ˆï¼‰

```
AIChatRoomPage/
â”œâ”€â”€ index.tsx              # ä¸»ç»„ä»¶ (1313è¡Œï¼Œå‡å°‘79è¡Œ)
â”œâ”€â”€ hooks/
â”‚   â”œâ”€â”€ index.ts
â”‚   â”œâ”€â”€ useImageUpload.ts  âœ… å·²æµ‹è¯• + å¾…é›†æˆ
â”‚   â”œâ”€â”€ useConversation.ts âœ… å·²æµ‹è¯• + å¾…é›†æˆ
â”‚   â””â”€â”€ useChat.ts         âœ… å·²æµ‹è¯• + å·²é›†æˆ
â”œâ”€â”€ components/
â”‚   â”œâ”€â”€ index.ts
â”‚   â”œâ”€â”€ MessageBubble.tsx  âœ… å·²åˆ›å»º + å¾…é›†æˆ
â”‚   â”œâ”€â”€ InputArea.tsx      âœ… å·²åˆ›å»º + å¾…é›†æˆ
â”‚   â””â”€â”€ HistoryDrawer.tsx  âœ… å·²åˆ›å»º + å·²é›†æˆ
â””â”€â”€ __tests__/
    â”œâ”€â”€ useImageUpload.test.ts
    â”œâ”€â”€ useConversation.test.ts
    â””â”€â”€ useChat.test.ts
```

### åç»­å¯ç»§ç»­ä¼˜åŒ–

| æ¨¡å— | é¢„è®¡å‡å°‘è¡Œæ•° | ä¼˜å…ˆçº§ |
|------|-------------|--------|
| useImageUpload é›†æˆ | ~30è¡Œ | ä¸­ |
| useConversation é›†æˆ | ~100è¡Œ | é«˜ |
| MessageBubble ç»„ä»¶é›†æˆ | ~80è¡Œ | ä¸­ |
| InputArea ç»„ä»¶é›†æˆ | ~50è¡Œ | ä¸­ |

å®Œå…¨é›†æˆåï¼Œä¸»ç»„ä»¶é¢„è®¡å¯é™è‡³ **~800è¡Œ**ï¼Œè¿›ä¸€æ­¥æ‹†åˆ†å¯è¾¾åˆ° **~300è¡Œ**ã€‚

---

## TDD é‡æ„ç¬¬ä¸‰é˜¶æ®µ - InputArea é›†æˆ

### æ–°å¢é›†æˆ

| æ¨¡å— | é›†æˆçŠ¶æ€ | å‡å°‘è¡Œæ•° |
|------|----------|----------|
| InputArea ç»„ä»¶ | âœ… å·²é›†æˆ | ~44è¡Œ |

### å½“å‰çŠ¶æ€

- **ä¸»ç»„ä»¶è¡Œæ•°**: 1313è¡Œ â†’ 1269è¡Œï¼ˆç´¯è®¡å‡å°‘123è¡Œï¼‰
- **æµ‹è¯•**: 26ä¸ªæµ‹è¯•å…¨éƒ¨é€šè¿‡
- **TypeScript**: ç¼–è¯‘æ— é”™è¯¯

### æœ€ç»ˆæ–‡ä»¶ç»“æ„

```
AIChatRoomPage/
â”œâ”€â”€ index.tsx              # ä¸»ç»„ä»¶ (1269è¡Œï¼Œå‡å°‘123è¡Œ)
â”œâ”€â”€ hooks/
â”‚   â”œâ”€â”€ index.ts
â”‚   â”œâ”€â”€ useImageUpload.ts  âœ… å·²æµ‹è¯•
â”‚   â”œâ”€â”€ useConversation.ts âœ… å·²æµ‹è¯•
â”‚   â””â”€â”€ useChat.ts         âœ… å·²æµ‹è¯• + å·²é›†æˆ
â”œâ”€â”€ components/
â”‚   â”œâ”€â”€ index.ts
â”‚   â”œâ”€â”€ MessageBubble.tsx  âœ… å·²åˆ›å»º
â”‚   â”œâ”€â”€ InputArea.tsx      âœ… å·²åˆ›å»º + å·²é›†æˆ
â”‚   â””â”€â”€ HistoryDrawer.tsx  âœ… å·²åˆ›å»º + å·²é›†æˆ
â””â”€â”€ __tests__/
    â”œâ”€â”€ useImageUpload.test.ts  (6 tests)
    â”œâ”€â”€ useConversation.test.ts (10 tests)
    â””â”€â”€ useChat.test.ts         (10 tests)
```

### é‡æ„æ€»ç»“

| é˜¶æ®µ | å†…å®¹ | å‡å°‘è¡Œæ•° |
|------|------|----------|
| ç¬¬ä¸€é˜¶æ®µ | åˆ›å»º hooks å’Œ components | - |
| ç¬¬äºŒé˜¶æ®µ | é›†æˆ useChat + HistoryDrawer | 79è¡Œ |
| ç¬¬ä¸‰é˜¶æ®µ | é›†æˆ InputArea | 44è¡Œ |
| **æ€»è®¡** | | **123è¡Œ** |

### æ”¶ç›Š

1. **å¯æµ‹è¯•æ€§**: 26ä¸ªå•å…ƒæµ‹è¯•è¦†ç›–æ ¸å¿ƒé€»è¾‘
2. **å¯ç»´æŠ¤æ€§**: é€»è¾‘åˆ†æ•£åˆ°ç‹¬ç«‹æ¨¡å—
3. **å¯å¤ç”¨æ€§**: hooks å’Œ components å¯åœ¨å…¶ä»–åœ°æ–¹å¤ç”¨
4. **æ¸è¿›å¼**: ä¸å½±å“ç°æœ‰åŠŸèƒ½ï¼Œéšæ—¶å¯ä»¥ç»§ç»­é‡æ„

---

## TDD é‡æ„æœ€ç»ˆé˜¶æ®µ - å®Œæˆ âœ…

### æœ€ç»ˆçŠ¶æ€ (2026-01-11)

- **ä¸»ç»„ä»¶è¡Œæ•°**: 1392è¡Œ â†’ **1012è¡Œ**ï¼ˆ**å‡å°‘380è¡Œï¼Œçº¦27%**ï¼‰
- **æµ‹è¯•**: 26ä¸ªæµ‹è¯•å…¨éƒ¨é€šè¿‡
- **TypeScript**: ç¼–è¯‘æ— é”™è¯¯

### æœ€ç»ˆæ–‡ä»¶ç»“æ„

```
AIChatRoomPage/
â”œâ”€â”€ index.tsx                    # ä¸»ç»„ä»¶ (1012è¡Œ)
â”œâ”€â”€ hooks/
â”‚   â”œâ”€â”€ index.ts                 (3è¡Œ)
â”‚   â”œâ”€â”€ useChat.ts               âœ… å·²é›†æˆ (68è¡Œ)
â”‚   â”œâ”€â”€ useImageUpload.ts        âœ… å·²é›†æˆ (47è¡Œ)
â”‚   â””â”€â”€ useConversation.ts       âœ… å·²é›†æˆ (128è¡Œ)
â”œâ”€â”€ components/
â”‚   â”œâ”€â”€ index.ts
â”‚   â”œâ”€â”€ MessageBubble.tsx        âœ… å·²é›†æˆ (189è¡Œ)
â”‚   â”œâ”€â”€ InputArea.tsx            âœ… å·²é›†æˆ (105è¡Œ)
â”‚   â”œâ”€â”€ HistoryDrawer.tsx        âœ… å·²é›†æˆ (145è¡Œ)
â”‚   â””â”€â”€ EditCharacterModal.tsx   âœ… å·²é›†æˆ (134è¡Œ)
â””â”€â”€ __tests__/
    â”œâ”€â”€ useChat.test.ts          (10 tests)
    â”œâ”€â”€ useImageUpload.test.ts   (6 tests)
    â””â”€â”€ useConversation.test.ts  (10 tests)
```

### å·²å®Œæˆçš„é›†æˆ

| æ¨¡å— | çŠ¶æ€ | è¯´æ˜ |
|------|------|------|
| useChat hook | âœ… å·²é›†æˆ | è¾“å…¥çŠ¶æ€ã€å‘é€çŠ¶æ€ã€ç¼–è¾‘æ¶ˆæ¯çŠ¶æ€ç®¡ç† |
| useImageUpload hook | âœ… å·²é›†æˆ | å›¾ç‰‡é€‰æ‹©ã€å‹ç¼©ã€ä¸Šä¼ ã€ç§»é™¤ |
| useConversation hook | âœ… å·²é›†æˆ | å¯¹è¯åˆ—è¡¨ç®¡ç†ã€åˆ‡æ¢ã€åˆ›å»ºã€åˆ é™¤ |
| MessageBubble ç»„ä»¶ | âœ… å·²é›†æˆ | æ¶ˆæ¯æ°”æ³¡æ¸²æŸ“ï¼ˆæµå¼ã€ç¼–è¾‘ã€æ­£å¸¸æ¨¡å¼ï¼‰ |
| InputArea ç»„ä»¶ | âœ… å·²é›†æˆ | è¾“å…¥åŒºåŸŸï¼ˆå›¾ç‰‡é¢„è§ˆã€æ–‡æœ¬è¾“å…¥ã€å‘é€æŒ‰é’®ï¼‰ |
| HistoryDrawer ç»„ä»¶ | âœ… å·²é›†æˆ | å†å²å¯¹è¯æŠ½å±‰ï¼ˆåˆ—è¡¨ã€ç¼–è¾‘æ ‡é¢˜ã€åˆ é™¤ï¼‰ |
| EditCharacterModal ç»„ä»¶ | âœ… å·²é›†æˆ | ç¼–è¾‘è§’è‰²å¼¹çª— |

### é‡æ„å†ç¨‹

| é˜¶æ®µ | å†…å®¹ | ä¸»ç»„ä»¶è¡Œæ•° |
|------|------|------------|
| åˆå§‹çŠ¶æ€ | åŸå§‹ä»£ç  | 1392è¡Œ |
| ç¬¬ä¸€é˜¶æ®µ | åˆ›å»º hooks å’Œ components + æµ‹è¯• | 1392è¡Œ |
| ç¬¬äºŒé˜¶æ®µ | é›†æˆ useChat + HistoryDrawer | 1313è¡Œ |
| ç¬¬ä¸‰é˜¶æ®µ | é›†æˆ InputArea | 1269è¡Œ |
| ç¬¬å››é˜¶æ®µ | é›†æˆ useImageUpload + EditCharacterModal | 1079è¡Œ |
| ç¬¬äº”é˜¶æ®µ | é›†æˆ MessageBubble | 1079è¡Œ |
| ç¬¬å…­é˜¶æ®µ | é›†æˆ useConversation + æ¸…ç†æœªä½¿ç”¨å¯¼å…¥ | **1012è¡Œ** |

### æ”¶ç›Šæ€»ç»“

1. **ä»£ç é‡å‡å°‘**: 1392è¡Œ â†’ 1012è¡Œï¼ˆå‡å°‘27%ï¼‰
2. **å¯æµ‹è¯•æ€§**: 26ä¸ªå•å…ƒæµ‹è¯•è¦†ç›–æ ¸å¿ƒé€»è¾‘
3. **å¯ç»´æŠ¤æ€§**: é€»è¾‘åˆ†æ•£åˆ°ç‹¬ç«‹æ¨¡å—ï¼ŒèŒè´£æ¸…æ™°
4. **å¯å¤ç”¨æ€§**: hooks å’Œ components å¯åœ¨å…¶ä»–åœ°æ–¹å¤ç”¨

### æœªå®Œæˆ/å¯é€‰ä¼˜åŒ–

| ä¼˜åŒ–é¡¹ | è¯´æ˜ | ä¼˜å…ˆçº§ |
|--------|------|--------|
| æµå¼å¤„ç†é€»è¾‘æå– | å°† handleSendã€handleRegenerateMessage ä¸­çš„æµå¼è¯»å–é€»è¾‘æå–ä¸ºç‹¬ç«‹å·¥å…·å‡½æ•° | ä½ |
| API é…ç½®æå– | å°† getApiConfigã€fixLocalUrl ç­‰å·¥å…·å‡½æ•°ç§»è‡³ utils ç›®å½• | ä½ |
| è¿›ä¸€æ­¥ç»„ä»¶æ‹†åˆ† | å¯å°†å¤´éƒ¨ã€èƒŒæ™¯è®¾ç½®ç­‰æ‹†åˆ†ä¸ºç‹¬ç«‹ç»„ä»¶ | å¯é€‰ |

### ç»“è®º

æœ¬æ¬¡ TDD é‡æ„å·²åŸºæœ¬å®Œæˆï¼Œä¸»ç»„ä»¶ä» 1392 è¡Œå‡å°‘åˆ° 1012 è¡Œï¼Œå‡å°‘çº¦ 27%ã€‚æ‰€æœ‰æ ¸å¿ƒé€»è¾‘éƒ½å·²æå–åˆ°ç‹¬ç«‹çš„ hooks å’Œ components ä¸­ï¼Œå¹¶æœ‰ 26 ä¸ªå•å…ƒæµ‹è¯•ä¿éšœä»£ç è´¨é‡ã€‚å‰©ä½™çš„ä¼˜åŒ–é¡¹ä¼˜å…ˆçº§è¾ƒä½ï¼Œå¯åœ¨åç»­åŠŸèƒ½å¼€å‘æ—¶é¡ºä¾¿å¤„ç†

















